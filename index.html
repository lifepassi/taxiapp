<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>íƒì‹œ ê¸°ì‚¬ ìš´í–‰ ì•±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 16px;
    }
    h1 {
      text-align: center;
      margin-bottom: 16px;
    }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    input, button {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ddd;
    }
    button {
      background: #007aff;
      color: #fff;
      border: none;
      cursor: pointer;
    }
    button:active {
      background: #005ecb;
    }
    .total {
      display: flex;
      justify-content: space-between;
      margin-top: 8px;
      font-weight: bold;
    }
    .record {
      border-bottom: 1px solid #eee;
      padding: 8px 0;
      font-size: 14px;
    }
  </style>
</head>
<body>

<h1>ğŸš• íƒì‹œ ê¸°ì‚¬ ì•±</h1>

<div class="card">
  <label>ì‚¬ë²ˆ</label>
  <input id="empId" placeholder="ì‚¬ë²ˆ ì…ë ¥">
  <button onclick="loadData()">ë¶ˆëŸ¬ì˜¤ê¸°</button>
</div>

<div class="card">
  <h3>ğŸ“Š ëˆ„ì  í•©ê³„</h3>
  <div class="total">ğŸ’° ìˆ˜ìµ <span id="tIncome">0</span></div>
  <div class="total">ğŸ“ ê±°ë¦¬ <span id="tDistance">0</span></div>
  <div class="total">â›½ LPG <span id="tLpg">0</span></div>
</div>

<div class="card">
  <h3>â• ì˜¤ëŠ˜ ê¸°ë¡</h3>
  <input id="income" placeholder="ìˆ˜ìµ">
  <input id="distance" placeholder="ê±°ë¦¬">
  <input id="lpg" placeholder="LPG">
  <button onclick="saveData()">ì €ì¥</button>
</div>

<div class="card">
  <h3>ğŸ“… ë‚ ì§œë³„ ê¸°ë¡</h3>
  <div id="records"></div>
</div>

<script>
const SCRIPT_URL = "ğŸ‘‰https://script.google.com/macros/s/AKfycbysFKS12TwPrCnkuSgIouihAwpl7R0b05P5i_H0zEkzssuCl2DGYWl_cTgZFpcz_mTT/execğŸ‘ˆ";

function loadData() {
  const empId = empIdInput();
  fetch(`${SCRIPT_URL}?empId=${empId}`)
    .then(res => res.json())
    .then(data => {
      tIncome.innerText = data.totalIncome.toLocaleString();
      tDistance.innerText = data.totalDistance;
      tLpg.innerText = data.totalLpg.toLocaleString();

      records.innerHTML = "";
      data.records.reverse().forEach(r => {
        records.innerHTML += `
          <div class="record">
            ${r.date} | ğŸ’° ${r.income} | ğŸ“ ${r.distance} | â›½ ${r.lpg}
          </div>
        `;
      });
    });
}

function saveData() {
  const empId = empIdInput();
  fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({
      empId,
      income: income.value,
      distance: distance.value,
      lpg: lpg.value
    })
  }).then(() => {
    income.value = "";
    distance.value = "";
    lpg.value = "";
    loadData();
  });
}

function empIdInput() {
  const v = empId.value.trim();
  if (!v) {
    alert("ì‚¬ë²ˆ ì…ë ¥í•˜ì„¸ìš”");
    throw "";
  }
  return v;
}
</script>

</body>
</html>
